============================= test session starts ==============================
platform linux -- Python 3.12.7, pytest-9.0.2, pluggy-1.6.0 -- /home/andreas/kiro/ip-man2/venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /home/andreas/kiro/ip-man2
configfile: pyproject.toml
plugins: hypothesis-6.149.1
collecting ... collected 258 items

tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_application_module_initialization PASSED [  0%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_authentication_sharing_across_submodules PASSED [  0%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_concurrent_submodule_execution PASSED [  1%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_credential_manager_integration PASSED [  1%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_data_correlation_across_submodules PASSED [  1%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_empty_configuration_handling PASSED [  2%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_get_available_submodules PASSED [  2%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_get_enabled_submodules PASSED [  3%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_ipv6_support_across_submodules PASSED [  3%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_load_all_submodules PASSED [  3%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_load_unknown_submodule_error PASSED [  4%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_multiple_failures_graceful_degradation PASSED [  4%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_partial_failure_isolation PASSED [  5%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_query_all_enabled_success FAILED [  5%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_query_specific_submodules PASSED [  5%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_set_credential_file PASSED [  6%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_standardized_result_formatting FAILED [  6%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_submodule_caching PASSED [  6%]
tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_validate_submodule_availability PASSED [  7%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_application_module_integration PASSED [  7%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_classification_crud_integration PASSED [  8%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_ipv6 PASSED [  8%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_localhost PASSED [  8%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_private_ipv4 PASSED [  9%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_public_ipv4 PASSED [  9%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_context_manager_cleanup PASSED [ 10%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_database_persistence_integration PASSED [ 10%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_error_aggregation PASSED [ 10%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_force_internet_module PASSED [ 11%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_get_available_modules PASSED [ 11%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_invalid_ip_address_handling PASSED [ 12%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_module_availability_validation PASSED [ 12%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_multiple_analyses_same_ip PASSED [ 12%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_multiple_different_ips PASSED [ 13%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_no_database_configuration PASSED [ 13%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_output_format_html_integration PASSED [ 13%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_output_format_human_integration PASSED [ 14%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_output_format_json_integration PASSED [ 14%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_partial_module_failure PASSED [ 15%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_reporting_mode_dense PASSED [ 15%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_reporting_mode_full PASSED [ 15%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_reporting_mode_full_err PASSED [ 16%]
tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_result_correlation PASSED [ 16%]
tests/integration/test_end_to_end_analysis.py::TestEdgeCases::test_broadcast_address PASSED [ 17%]
tests/integration/test_end_to_end_analysis.py::TestEdgeCases::test_empty_string_ip PASSED [ 17%]
tests/integration/test_end_to_end_analysis.py::TestEdgeCases::test_link_local_ipv6 PASSED [ 17%]
tests/integration/test_end_to_end_analysis.py::TestEdgeCases::test_multicast_address PASSED [ 18%]
tests/integration/test_end_to_end_analysis.py::TestEdgeCases::test_whitespace_ip PASSED [ 18%]
tests/integration/test_ux_enhancements.py::TestHumanFormatFlag::test_human_format_is_default PASSED [ 18%]
tests/integration/test_ux_enhancements.py::TestHumanFormatFlag::test_human_format_explicit PASSED [ 19%]
tests/integration/test_ux_enhancements.py::TestHumanFormatFlag::test_json_format_overrides_default PASSED [ 19%]
tests/integration/test_ux_enhancements.py::TestHumanFormatFlag::test_html_format_overrides_default PASSED [ 20%]
tests/integration/test_ux_enhancements.py::TestRunRootFlag::test_run_root_default_false PASSED [ 20%]
tests/integration/test_ux_enhancements.py::TestRunRootFlag::test_run_root_explicit_true PASSED [ 20%]
tests/integration/test_ux_enhancements.py::TestRunRootFlag::test_local_info_module_respects_run_root PASSED [ 21%]
tests/integration/test_ux_enhancements.py::TestRunRootFlag::test_root_privilege_detection PASSED [ 21%]
tests/integration/test_ux_enhancements.py::TestImprovedReadability::test_human_formatter_color_support_detection PASSED [ 22%]
tests/integration/test_ux_enhancements.py::TestImprovedReadability::test_human_formatter_section_headers PASSED [ 22%]
tests/integration/test_ux_enhancements.py::TestImprovedReadability::test_human_formatter_key_value_formatting PASSED [ 22%]
tests/integration/test_ux_enhancements.py::TestTracerouteTreeVisualization::test_human_formatter_traceroute_tree PASSED [ 23%]
tests/integration/test_ux_enhancements.py::TestTracerouteTreeVisualization::test_html_formatter_traceroute_tree PASSED [ 23%]
tests/integration/test_ux_enhancements.py::TestNATDetection::test_rfc1918_detection PASSED [ 24%]
tests/integration/test_ux_enhancements.py::TestNATDetection::test_nat_detection_structure PASSED [ 24%]
tests/integration/test_ux_enhancements.py::TestNATDetection::test_nat_detection_can_be_disabled PASSED [ 24%]
tests/integration/test_ux_enhancements.py::TestNoCertCheckOption::test_verify_ssl_default_true PASSED [ 25%]
tests/integration/test_ux_enhancements.py::TestNoCertCheckOption::test_verify_ssl_can_be_disabled PASSED [ 25%]
tests/integration/test_ux_enhancements.py::TestNoCertCheckOption::test_local_info_module_respects_verify_ssl PASSED [ 25%]
tests/integration/test_ux_enhancements.py::TestIntegrationOfAllEnhancements::test_config_with_all_enhancements PASSED [ 26%]
tests/integration/test_ux_enhancements.py::TestIntegrationOfAllEnhancements::test_local_info_module_with_all_enhancements PASSED [ 26%]
tests/integration/test_ux_enhancements.py::TestIntegrationOfAllEnhancements::test_formatters_work_with_enhanced_data PASSED [ 27%]
tests/property/test_application_integration_error_handling.py::TestApplicationIntegrationErrorHandling::test_application_integration_graceful_error_handling PASSED [ 27%]
tests/property/test_application_integration_error_handling.py::TestApplicationIntegrationErrorHandling::test_partial_failure_isolation PASSED [ 27%]
tests/property/test_application_integration_error_handling.py::TestApplicationIntegrationErrorHandling::test_missing_configuration_handling FAILED [ 28%]
tests/property/test_application_integration_error_handling.py::TestApplicationIntegrationErrorHandling::test_authentication_configuration_robustness PASSED [ 28%]
tests/property/test_classification_accuracy.py::TestClassificationAccuracy::test_classification_returns_valid_results PASSED [ 29%]
tests/property/test_classification_accuracy.py::TestClassificationAccuracy::test_classification_consistency_with_rfc_ranges PASSED [ 29%]
tests/property/test_classification_accuracy.py::TestClassificationAccuracy::test_custom_classification_accuracy PASSED [ 29%]
tests/property/test_classification_consistency.py::TestClassificationConsistency::test_classification_results_consistent_with_json_definitions PASSED [ 30%]
tests/property/test_classification_consistency.py::TestClassificationConsistency::test_classification_includes_valid_qualifies_for_modules PASSED [ 30%]
tests/property/test_classification_consistency.py::TestClassificationConsistency::test_classification_module_qualification_consistency PASSED [ 31%]
tests/property/test_classification_consistency.py::TestClassificationConsistency::test_classification_deterministic_behavior PASSED [ 31%]
tests/property/test_classification_consistency.py::TestClassificationConsistency::test_classification_json_file_consistency_after_reload PASSED [ 31%]
tests/property/test_classification_crud.py::TestClassificationCRUDOperations::test_add_classification_persists_to_json PASSED [ 32%]
tests/property/test_classification_crud.py::TestClassificationCRUDOperations::test_delete_classification_removes_from_json PASSED [ 32%]
tests/property/test_classification_crud.py::TestClassificationCRUDOperations::test_delete_nonexistent_classification_returns_false PASSED [ 32%]
tests/property/test_classification_crud.py::TestClassificationCRUDOperations::test_update_classification_modifies_json PASSED [ 33%]
tests/property/test_classification_crud.py::TestClassificationCRUDOperations::test_update_nonexistent_classification_returns_false PASSED [ 33%]
tests/property/test_classification_crud.py::TestClassificationCRUDOperations::test_multiple_crud_operations_maintain_consistency PASSED [ 34%]
tests/property/test_conditional_ssl_testing.py::TestConditionalSSLTesting::test_ssl_testing_for_web_and_mail_ports PASSED [ 34%]
tests/property/test_conditional_ssl_testing.py::TestConditionalSSLTesting::test_ssl_testing_skipped_for_non_eligible_ports PASSED [ 34%]
tests/property/test_conditional_ssl_testing.py::TestConditionalSSLTesting::test_ssl_port_identification_accuracy PASSED [ 35%]
tests/property/test_conditional_ssl_testing.py::TestSSLAnalysisErrorHandling::test_ssl_analysis_with_connection_failures PASSED [ 35%]
tests/property/test_configuration_file_processing.py::test_configuration_file_processing_property PASSED [ 36%]
tests/property/test_configuration_file_processing.py::test_cli_args_override_config_file FAILED [ 36%]
tests/property/test_configuration_file_processing.py::test_config_file_not_found_uses_defaults PASSED [ 36%]
tests/property/test_configuration_file_processing.py::test_config_file_invalid_json_raises_error PASSED [ 37%]
tests/property/test_configuration_file_processing.py::test_config_file_partial_settings PASSED [ 37%]
tests/property/test_configuration_file_processing.py::test_config_roundtrip_preserves_all_settings PASSED [ 37%]
tests/property/test_database_location_config.py::TestDatabaseLocationConfiguration::test_database_location_configuration_compliance PASSED [ 38%]
tests/property/test_database_location_config.py::TestDatabaseLocationConfiguration::test_multiple_database_locations_isolation PASSED [ 38%]
tests/property/test_database_location_config.py::TestDatabaseLocationConfiguration::test_default_database_location_behavior PASSED [ 39%]
tests/property/test_database_location_config.py::TestDatabaseLocationConfiguration::test_database_path_persistence_across_operations PASSED [ 39%]
tests/property/test_database_location_config.py::TestDatabaseLocationConfiguration::test_database_location_with_nonexistent_parent_directories PASSED [ 39%]
tests/property/test_database_persistence.py::TestDatabasePersistence::test_scan_result_storage_completeness FAILED [ 40%]
tests/property/test_database_persistence.py::TestDatabasePersistence::test_multiple_scan_storage_and_retrieval PASSED [ 40%]
tests/property/test_database_persistence.py::TestDatabasePersistence::test_scan_history_retrieval_by_ip PASSED [ 41%]
tests/property/test_database_persistence.py::TestDatabasePersistence::test_database_file_creation_in_specified_location PASSED [ 41%]
tests/property/test_database_persistence.py::TestDatabasePersistence::test_scan_timestamp_system_invoking_requirement PASSED [ 41%]
tests/property/test_dense_mode_filtering.py::TestDenseModeFiltering::test_dense_mode_includes_meaningful_data PASSED [ 42%]
tests/property/test_dense_mode_filtering.py::TestDenseModeFiltering::test_dense_mode_excludes_empty_data PASSED [ 42%]
tests/property/test_dense_mode_filtering.py::TestDenseModeFiltering::test_dense_vs_full_mode_difference PASSED [ 43%]
tests/property/test_dense_mode_filtering.py::TestDenseModeFiltering::test_dense_mode_consistency_across_formatters PASSED [ 43%]
tests/property/test_dense_mode_filtering.py::TestDenseModeFiltering::test_meaningful_data_detection_edge_cases PASSED [ 43%]
tests/property/test_full_mode_completeness.py::TestFullModeCompleteness::test_full_mode_includes_all_sections PASSED [ 44%]
tests/property/test_full_mode_completeness.py::TestFullModeCompleteness::test_full_mode_vs_dense_mode_completeness PASSED [ 44%]
tests/property/test_full_mode_completeness.py::TestFullModeCompleteness::test_full_mode_no_results_marking PASSED [ 44%]
tests/property/test_full_mode_completeness.py::TestFullModeCompleteness::test_full_mode_consistency_across_formatters FAILED [ 45%]
tests/property/test_full_mode_completeness.py::TestFullModeCompleteness::test_full_mode_preserves_meaningful_data PASSED [ 45%]
tests/property/test_full_mode_completeness.py::TestFullModeCompleteness::test_full_mode_empty_result_handling PASSED [ 46%]
tests/property/test_internet_information_gathering.py::TestInternetInformationGathering::test_internet_information_gathering_completeness_property PASSED [ 46%]
tests/property/test_internet_information_gathering.py::TestInternetInformationGathering::test_whois_lookup_structure_property PASSED [ 46%]
tests/property/test_internet_information_gathering.py::TestInternetInformationGathering::test_reverse_dns_lookup_property PASSED [ 47%]
tests/property/test_internet_information_gathering.py::TestInternetInformationGathering::test_asn_information_property PASSED [ 47%]
tests/property/test_internet_information_gathering.py::TestInternetInformationGathering::test_geolocation_data_property PASSED [ 48%]
tests/property/test_internet_information_gathering.py::TestInternetInformationGathering::test_blocklist_results_structure_property PASSED [ 48%]
tests/property/test_internet_module_qualification.py::TestInternetModuleQualification::test_internet_module_qualification_property PASSED [ 48%]
tests/property/test_internet_module_qualification.py::TestInternetModuleQualification::test_force_flag_override_property PASSED [ 49%]
tests/property/test_internet_module_qualification.py::TestInternetModuleQualification::test_classification_consistency_property PASSED [ 49%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_valid_ipv4_addresses_accepted PASSED [ 50%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_valid_ipv6_addresses_accepted PASSED [ 50%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_ip_format_validation_consistency PASSED [ 50%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_invalid_ip_addresses_rejected PASSED [ 51%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_empty_and_whitespace_rejected PASSED [ 51%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_non_string_input_rejected PASSED [ 51%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_ip_normalization_consistency PASSED [ 52%]
tests/property/test_ip_validation.py::TestIPAddressValidation::test_version_detection_accuracy PASSED [ 52%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_ipv4_processing_consistency PASSED [ 53%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_ipv6_processing_consistency PASSED [ 53%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_version_consistency_across_operations PASSED [ 53%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_subnet_operations_version_consistency PASSED [ 54%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_ip_comparison_version_handling PASSED [ 54%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_batch_processing_version_consistency PASSED [ 55%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_analyzer_version_consistency FAILED [ 55%]
tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_subnet_membership_version_compatibility PASSED [ 55%]
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_local_analysis_completeness PASSED [ 56%]
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_analysis_methods_attempted PASSED [ 56%]
tests/property/test_local_network_analysis.py::TestLocalAnalysisErrorHandling::test_graceful_error_handling PASSED [ 56%]
tests/property/test_mac_address_processing.py::TestMACAddressProcessing::test_mac_vendor_decoding PASSED [ 57%]
tests/property/test_mac_address_processing.py::TestMACAddressProcessing::test_mac_vendor_consistency PASSED [ 57%]
tests/property/test_mac_address_processing.py::TestMACAddressProcessing::test_gateway_classification_logic PASSED [ 58%]
tests/property/test_mac_address_processing.py::TestMACAddressProcessing::test_mac_address_normalization PASSED [ 58%]
tests/property/test_mac_address_processing.py::TestMACAddressErrorHandling::test_mac_discovery_failure_handling PASSED [ 58%]
tests/property/test_mac_address_processing.py::TestMACAddressErrorHandling::test_vendor_lookup_error_handling PASSED [ 59%]
tests/property/test_module4_access_control.py::TestModule4AccessControl::test_module4_requires_explicit_submodule_specification FAILED [ 59%]
tests/property/test_module4_access_control.py::TestModule4AccessControl::test_module4_validates_submodule_availability PASSED [ 60%]
tests/property/test_module4_access_control.py::TestModule4AccessControl::test_module4_individual_submodule_specification_required PASSED [ 60%]
tests/property/test_module4_access_control.py::TestModule4AccessControl::test_module4_no_default_execution PASSED [ 60%]
tests/property/test_module_availability_validation.py::test_module_availability_validation_property PASSED [ 61%]
tests/property/test_module_availability_validation.py::test_module_availability_with_all_core_modules PASSED [ 61%]
tests/property/test_module_availability_validation.py::test_module_availability_with_invalid_modules PASSED [ 62%]
tests/property/test_module_availability_validation.py::test_module_availability_empty_list PASSED [ 62%]
tests/property/test_module_availability_validation.py::test_get_available_modules PASSED [ 62%]
tests/property/test_module_availability_validation.py::test_module_availability_with_credentials PASSED [ 63%]
tests/property/test_output_format_validity.py::TestOutputFormatValidity::test_json_format_validity PASSED [ 63%]
tests/property/test_output_format_validity.py::TestOutputFormatValidity::test_html_format_validity PASSED [ 63%]
tests/property/test_output_format_validity.py::TestOutputFormatValidity::test_human_format_validity FAILED [ 64%]
tests/property/test_output_format_validity.py::TestOutputFormatValidity::test_format_consistency_across_verbosity_modes PASSED [ 64%]
tests/property/test_output_format_validity.py::TestOutputFormatValidity::test_verbosity_mode_validation PASSED [ 65%]
tests/property/test_output_format_validity.py::TestOutputFormatValidity::test_invalid_verbosity_mode_rejection PASSED [ 65%]
tests/property/test_project_structure.py::TestProjectStructureCompliance::test_required_directories_exist PASSED [ 65%]
tests/property/test_project_structure.py::TestProjectStructureCompliance::test_required_files_exist PASSED [ 66%]
tests/property/test_project_structure.py::TestProjectStructureCompliance::test_python_package_structure PASSED [ 66%]
tests/property/test_project_structure.py::TestProjectStructureCompliance::test_virtual_environment_exists PASSED [ 67%]
tests/property/test_project_structure.py::TestProjectStructureCompliance::test_configuration_files_valid PASSED [ 67%]
tests/property/test_project_structure.py::TestProjectStructureCompliance::test_module_directories_structure PASSED [ 67%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_blocklist_checking_returns_structured_results PASSED [ 68%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_reputation_score_calculation_bounds PASSED [ 68%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_reputation_score_inverse_correlation PASSED [ 68%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_dns_blocklist_ipv4_handling PASSED [ 69%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_dns_blocklist_ipv6_handling PASSED [ 69%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_crowdsec_check_structure PASSED [ 70%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_reputation_score_empty_list_handling PASSED [ 70%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_mode_specific_filtering_behavior PASSED [ 70%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_reputation_services_error_handling PASSED [ 71%]
tests/property/test_reputation_checking_behavior.py::TestReputationCheckingBehavior::test_reputation_score_consistency PASSED [ 71%]
tests/property/test_ssl_certificate_deduplication.py::TestSSLCertificateDeduplication::test_identical_certificates_reported_once FAILED [ 72%]
tests/property/test_ssl_certificate_deduplication.py::TestSSLCertificateDeduplication::test_different_certificates_reported_separately PASSED [ 72%]
tests/property/test_ssl_certificate_deduplication.py::TestSSLCertificateDeduplication::test_certificate_deduplication_with_port_differences FAILED [ 72%]
tests/property/test_ssl_certificate_deduplication.py::TestCertificateDeduplicationErrorHandling::test_deduplication_with_missing_certificate_data PASSED [ 73%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_api_error_404 PASSED [ 73%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_api_error_500 PASSED [ 74%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_authentication_failure_401 PASSED [ 74%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_authentication_failure_403 PASSED [ 74%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_checkmk_initialization_with_config PASSED [ 75%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_checkmk_initialization_without_config PASSED [ 75%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_connection_error PASSED [ 75%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_connection_timeout PASSED [ 76%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_multiple_hosts_same_ip PASSED [ 76%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_multiple_test_ips PASSED [ 77%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_no_config_error PASSED [ 77%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_partial_failure_service_query PASSED [ 77%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_query_ip_success_minimal_data PASSED [ 78%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_query_ip_success_with_full_data PASSED [ 78%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_query_ipv6_address PASSED [ 79%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_service_with_performance_data PASSED [ 79%]
tests/unit/test_checkmk_submodule.py::TestCheckMKSubmodule::test_unexpected_exception_handling PASSED [ 79%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_private_ipv4_class_a PASSED [ 80%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_private_ipv4_class_b PASSED [ 80%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_private_ipv4_class_c PASSED [ 81%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_localhost_ipv4 PASSED [ 81%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_link_local_ipv4 PASSED [ 81%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_multicast_ipv4 PASSED [ 82%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_broadcast_ipv4 PASSED [ 82%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_localhost_ipv6 PASSED [ 82%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_private_ipv6_unique_local PASSED [ 83%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_link_local_ipv6 PASSED [ 83%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_multicast_ipv6 PASSED [ 84%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_public_ipv4_fallback PASSED [ 84%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classify_public_ipv6_fallback PASSED [ 84%]
tests/unit/test_classification_module.py::TestClassificationModule::test_edge_case_ipv4_boundaries PASSED [ 85%]
tests/unit/test_classification_module.py::TestClassificationModule::test_custom_classification_rule_handling PASSED [ 85%]
tests/unit/test_classification_module.py::TestClassificationModule::test_overlapping_classification_rules PASSED [ 86%]
tests/unit/test_classification_module.py::TestClassificationModule::test_get_qualified_modules PASSED [ 86%]
tests/unit/test_classification_module.py::TestClassificationModule::test_create_default_classifications PASSED [ 86%]
tests/unit/test_classification_module.py::TestClassificationModule::test_invalid_ip_range_handling PASSED [ 87%]
tests/unit/test_classification_module.py::TestClassificationModule::test_classification_with_no_config_manager PASSED [ 87%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_api_error_404 PASSED [ 87%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_api_error_500 PASSED [ 88%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_authentication_failure_401 PASSED [ 88%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_authentication_failure_403 PASSED [ 89%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_connection_error PASSED [ 89%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_connection_timeout PASSED [ 89%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_multiple_test_ips PASSED [ 90%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_netbox_initialization_with_config PASSED [ 90%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_netbox_initialization_without_config PASSED [ 91%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_no_config_error PASSED [ 91%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_partial_failure_interface_query FAILED [ 91%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_query_ip_success_minimal_data PASSED [ 92%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_query_ip_success_with_full_data FAILED [ 92%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_query_ipv6_address PASSED [ 93%]
tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_vlan_deduplication PASSED [ 93%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_api_error_404 PASSED [ 93%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_api_error_500 PASSED [ 94%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_authentication_failure_401 PASSED [ 94%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_authentication_failure_403 PASSED [ 94%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_connection_error PASSED [ 95%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_connection_timeout PASSED [ 95%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_cve_extraction_from_results PASSED [ 96%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_multiple_test_ips PASSED [ 96%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_no_config_error PASSED [ 96%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_openvas_initialization_with_config PASSED [ 97%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_openvas_initialization_without_config PASSED [ 97%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_partial_failure_task_query PASSED [ 98%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_query_ip_success_minimal_data PASSED [ 98%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_query_ip_success_with_full_data PASSED [ 98%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_query_ipv6_address PASSED [ 99%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_scan_history_extraction PASSED [ 99%]
tests/unit/test_openvas_submodule.py::TestOpenVASSubmodule::test_severity_classification PASSED [100%]

=================================== FAILURES ===================================
E   AssertionError: 'NetBox (netbox.example.com:443)' != 'netbox'
    - NetBox (netbox.example.com:443)
    + netbox
/home/andreas/anaconda3/lib/python3.12/unittest/case.py:715: AssertionError: 'NetBox (netbox.example.com:443)' != 'netbox'
E   AssertionError: 'NetBox (netbox.example.com:443)' != 'netbox'
    - NetBox (netbox.example.com:443)
    + netbox
/home/andreas/anaconda3/lib/python3.12/unittest/case.py:715: AssertionError: 'NetBox (netbox.example.com:443)' != 'netbox'
E   AssertionError: Result should indicate failure for missing configuration
    assert True is False
     +  where True = ApplicationResult(success=True, data={'ip_addresses': [], 'prefixes': [], 'devices': [], 'interfaces': [], 'vlans': [], 'vrfs': [], 'virtual_machines': [], 'clusters': [], 'sites': [], 'tenants': [], 'contacts': [], 'ip_ranges': [], 'aggregates': [{'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/aggregates/1/', 'display_url': 'https://netbox.adminsend.local/ipam/aggregates/1/', 'display': '10.0.0.0/8', 'family': {'value': 4, 'label': 'IPv4'}, 'prefix': '10.0.0.0/8', 'rir': {'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/rirs/1/', 'display': 'RFC1918', 'name': 'RFC1918', 'slug': 'rfc1918', 'description': ''}, 'tenant': None, 'date_added': None, 'description': '', 'comments': '', 'tags': [], 'custom_fields': {}, 'created': '2023-07-08T23:12:48.518670Z', 'last_updated': '2023-07-08T23:12:48.518689Z', 'web_url': 'https://netbox.adminsend.local/ipam/aggregates/1/'}, {'id': 2, 'url': 'https://netbox.adminsend.local/api/ipam/aggregates/2/', 'display_url': 'https://netbox.adminsend.local/ipam/aggregates/2/', 'display': '172.16.0.0/12', 'family': {'value': 4, 'label': 'IPv4'}, 'prefix': '172.16.0.0/12', 'rir': {'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/rirs/1/', 'display': 'RFC1918', 'name': 'RFC1918', 'slug': 'rfc1918', 'description': ''}, 'tenant': None, 'date_added': None, 'description': '', 'comments': '', 'tags': [], 'custom_fields': {}, 'created': '2023-07-08T23:13:12.305141Z', 'last_updated': '2023-07-08T23:13:12.305158Z', 'web_url': 'https://netbox.adminsend.local/ipam/aggregates/2/'}, {'id': 3, 'url': 'https://netbox.adminsend.local/api/ipam/aggregates/3/', 'display_url': 'https://netbox.adminsend.local/ipam/aggregates/3/', 'display': '192.168.0.0/16', 'family': {'value': 4, 'label': 'IPv4'}, 'prefix': '192.168.0.0/16', 'rir': {'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/rirs/1/', 'display': 'RFC1918', 'name': 'RFC1918', 'slug': 'rfc1918', 'description': ''}, 'tenant': None, 'date_added': None, 'description': '', 'comments': '', 'tags': [], 'custom_fields': {}, 'created': '2023-07-08T23:13:34.549284Z', 'last_updated': '2023-07-08T23:13:34.549300Z', 'web_url': 'https://netbox.adminsend.local/ipam/aggregates/3/'}], 'services': [], 'source': 'NetBox IPAM', 'base_url': 'https://netbox.adminsend.local'}, error_message=None, source='NetBox (netbox.adminsend.local:443)', timestamp=None).success

During handling of the above exception, another exception occurred:
E   Failed: Submodule netbox should handle missing configuration gracefully, but raised: Result should indicate failure for missing configuration
    assert True is False
     +  where True = ApplicationResult(success=True, data={'ip_addresses': [], 'prefixes': [], 'devices': [], 'interfaces': [], 'vlans': [], 'vrfs': [], 'virtual_machines': [], 'clusters': [], 'sites': [], 'tenants': [], 'contacts': [], 'ip_ranges': [], 'aggregates': [{'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/aggregates/1/', 'display_url': 'https://netbox.adminsend.local/ipam/aggregates/1/', 'display': '10.0.0.0/8', 'family': {'value': 4, 'label': 'IPv4'}, 'prefix': '10.0.0.0/8', 'rir': {'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/rirs/1/', 'display': 'RFC1918', 'name': 'RFC1918', 'slug': 'rfc1918', 'description': ''}, 'tenant': None, 'date_added': None, 'description': '', 'comments': '', 'tags': [], 'custom_fields': {}, 'created': '2023-07-08T23:12:48.518670Z', 'last_updated': '2023-07-08T23:12:48.518689Z', 'web_url': 'https://netbox.adminsend.local/ipam/aggregates/1/'}, {'id': 2, 'url': 'https://netbox.adminsend.local/api/ipam/aggregates/2/', 'display_url': 'https://netbox.adminsend.local/ipam/aggregates/2/', 'display': '172.16.0.0/12', 'family': {'value': 4, 'label': 'IPv4'}, 'prefix': '172.16.0.0/12', 'rir': {'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/rirs/1/', 'display': 'RFC1918', 'name': 'RFC1918', 'slug': 'rfc1918', 'description': ''}, 'tenant': None, 'date_added': None, 'description': '', 'comments': '', 'tags': [], 'custom_fields': {}, 'created': '2023-07-08T23:13:12.305141Z', 'last_updated': '2023-07-08T23:13:12.305158Z', 'web_url': 'https://netbox.adminsend.local/ipam/aggregates/2/'}, {'id': 3, 'url': 'https://netbox.adminsend.local/api/ipam/aggregates/3/', 'display_url': 'https://netbox.adminsend.local/ipam/aggregates/3/', 'display': '192.168.0.0/16', 'family': {'value': 4, 'label': 'IPv4'}, 'prefix': '192.168.0.0/16', 'rir': {'id': 1, 'url': 'https://netbox.adminsend.local/api/ipam/rirs/1/', 'display': 'RFC1918', 'name': 'RFC1918', 'slug': 'rfc1918', 'description': ''}, 'tenant': None, 'date_added': None, 'description': '', 'comments': '', 'tags': [], 'custom_fields': {}, 'created': '2023-07-08T23:13:34.549284Z', 'last_updated': '2023-07-08T23:13:34.549300Z', 'web_url': 'https://netbox.adminsend.local/ipam/aggregates/3/'}], 'services': [], 'source': 'NetBox IPAM', 'base_url': 'https://netbox.adminsend.local'}, error_message=None, source='NetBox (netbox.adminsend.local:443)', timestamp=None).success
    Falsifying example: test_missing_configuration_handling(
        self=<tests.property.test_application_integration_error_handling.TestApplicationIntegrationErrorHandling object at 0x7627fe06e330>,
        submodule_name='netbox',
        ip_address=IPv4Address(0),
    )
------------------------------ Captured log call -------------------------------
WARNING  ip_sentinel.modules.application:application.py:221 SSL certificate verification disabled for NetBoxSubmodule
WARNING  ip_sentinel.modules.application:application.py:221 SSL certificate verification disabled for NetBoxSubmodule
/home/andreas/kiro/ip-man2/tests/property/test_application_integration_error_handling.py:239: Failed: Submodule netbox should handle missing configuration gracefully, but raised: Result should indicate failure for missing configuration
  + Exception Group Traceback (most recent call last):
  |   File "/home/andreas/kiro/ip-man2/tests/property/test_configuration_file_processing.py", line 117, in test_cli_args_override_config_file
  |     @given(
  |             
  |   File "/home/andreas/kiro/ip-man2/venv/lib/python3.12/site-packages/hypothesis/core.py", line 2246, in wrapped_test
  |     raise the_error_hypothesis_found
  | ExceptionGroup: Hypothesis found 2 distinct failures. (2 sub-exceptions)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/andreas/kiro/ip-man2/tests/property/test_configuration_file_processing.py", line 167, in test_cli_args_override_config_file
    |     config = build_config_from_args(args)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/andreas/kiro/ip-man2/src/ip_sentinel/cli.py", line 351, in build_config_from_args
    |     verify_ssl = not args.no_cert_check
    |                      ^^^^^^^^^^^^^^^^^^
    | AttributeError: 'Namespace' object has no attribute 'no_cert_check'
    | Falsifying example: test_cli_args_override_config_file(
    |     output_format='json',
    |     reporting_mode='dense',
    |     force_internet=False,
    |     verbose=False,
    | )
    +---------------- 2 ----------------
    | Traceback (most recent call last):
    |   File "/home/andreas/kiro/ip-man2/tests/property/test_configuration_file_processing.py", line 167, in test_cli_args_override_config_file
    |     config = build_config_from_args(args)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/andreas/kiro/ip-man2/src/ip_sentinel/cli.py", line 322, in build_config_from_args
    |     elif args.human:
    |          ^^^^^^^^^^
    | AttributeError: 'Namespace' object has no attribute 'human'
    | Falsifying example: test_cli_args_override_config_file(
    |     output_format='human',
    |     reporting_mode='dense',
    |     force_internet=False,
    |     verbose=False,
    | )
    +------------------------------------
/home/andreas/kiro/ip-man2/tests/property/test_configuration_file_processing.py:117: ExceptionGroup: Hypothesis found 2 distinct failures. (2 sub-exceptions)
E   AssertionError: Module 'classification' results should be stored
    assert 'classification' in {}
    Falsifying example: test_scan_result_storage_completeness(
        self=<tests.property.test_database_persistence.TestDatabasePersistence object at 0x7627fdf48260>,
        scan_result={'ip_address': IPv4Address('0.0.0.0'),
         'ip_version': 4,
         'scan_timestamp': datetime.datetime(2020, 1, 1, 0, 0),
         'scan_duration_ms': 1,
         'modules_executed': ['classification'],
         'module_results': {'classification': {'success': False,
           'data': {},
           'error_message': '0'}}},
    )
/home/andreas/kiro/ip-man2/tests/property/test_database_persistence.py:197: AssertionError: Module 'classification' results should be stored
E   AssertionError: Human formatter should contain report title in full mode
    assert 'IP Intelligence Analysis Report' in 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n  IP INTELLIGENCE ANALYSIS REPORT\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n  IP Address: 0.0.0.0\n  Scan Time: 2020-01-01 00:00:00\n\n\nğŸ“‹ Classifications\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  â€¢ no results\n\n\nğŸ  Local Network Information\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  no results\n\n\nğŸŒ Internet Information\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  no results\n\n\nğŸ”§ Application Information\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  no results\n\n\nâš ï¸  Errors and Issues\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  âš  no results\n\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'
    Falsifying example: test_full_mode_consistency_across_formatters(
        self=<tests.property.test_full_mode_completeness.TestFullModeCompleteness object at 0x7627fdf6de20>,
        result=AnalysisResult(ip_address=IPv4Address('0.0.0.0'),
         scan_timestamp=datetime.datetime(2020, 1, 1, 0, 0),
         classifications=[],
         local_info=None,
         internet_info=None,
         application_info={},
         errors=[]),
    )
/home/andreas/kiro/ip-man2/tests/property/test_full_mode_completeness.py:348: AssertionError: Human formatter should contain report title in full mode
E   hypothesis.errors.DeadlineExceeded: Test took 7376.36ms, which exceeds the deadline of 200.00ms. If you expect test cases to take this long, you can use @settings(deadline=...) to either set a higher deadline, or to disable it with deadline=None.
    Falsifying example: test_analyzer_version_consistency(
        self=<tests.property.test_ip_version_consistency.TestIPVersionConsistency object at 0x7627fddd2240>,
        ip_addr=IPv4Address(b'\x00\x00\x00\x00'),
    )
------------------------------ Captured log call -------------------------------
WARNING  src.ip_sentinel.modules.internet_info:internet_info.py:181 WHOIS lookup failed for 0.0.0.0: IPv4 address 0.0.0.0 is already defined as This Network via RFC 1122, Section 3.2.1.3.
WARNING  src.ip_sentinel.modules.internet_info:internet_info.py:253 ASN lookup failed for 0.0.0.0: IPv4 address 0.0.0.0 is already defined as This Network via RFC 1122, Section 3.2.1.3.
WARNING  src.ip_sentinel.modules.internet_info:internet_info.py:181 WHOIS lookup failed for 0.0.0.0: IPv4 address 0.0.0.0 is already defined as This Network via RFC 1122, Section 3.2.1.3.
WARNING  src.ip_sentinel.modules.internet_info:internet_info.py:253 ASN lookup failed for 0.0.0.0: IPv4 address 0.0.0.0 is already defined as This Network via RFC 1122, Section 3.2.1.3.
/home/andreas/kiro/ip-man2/venv/lib/python3.12/site-packages/hypothesis/core.py:1041: hypothesis.errors.DeadlineExceeded: Test took 7376.36ms, which exceeds the deadline of 200.00ms. If you expect test cases to take this long, you can use @settings(deadline=...) to either set a higher deadline, or to disable it with deadline=None.
E   AssertionError: assert 'NetBox (netb...nd.local:443)' == 'netbox'
      
      - netbox
      + NetBox (netbox.adminsend.local:443)
    Falsifying example: test_module4_requires_explicit_submodule_specification(
        self=<tests.property.test_module4_access_control.TestModule4AccessControl object at 0x7627fde02240>,
        submodule_names=['netbox', 'checkmk'],
        ip_address=IPv4Address(0),
    )
------------------------------ Captured log call -------------------------------
WARNING  ip_sentinel.modules.application:application.py:221 SSL certificate verification disabled for NetBoxSubmodule
WARNING  ip_sentinel.modules.application:application.py:221 SSL certificate verification disabled for CheckMKSubmodule
WARNING  ip_sentinel.modules.application:application.py:221 SSL certificate verification disabled for NetBoxSubmodule
WARNING  ip_sentinel.modules.application:application.py:221 SSL certificate verification disabled for CheckMKSubmodule
/home/andreas/kiro/ip-man2/tests/property/test_module4_access_control.py:73: AssertionError: assert 'NetBox (netb...nd.local:443)' == 'netbox'
E   AssertionError: Should contain report title
    assert 'IP Intelligence Analysis Report' in 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n  IP INTELLIGENCE ANALYSIS REPORT\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n  IP Address: 0.0.0.0\n  Scan Time: 2020-01-01 00:00:00\n\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'
    Falsifying example: test_human_format_validity(
        self=<tests.property.test_output_format_validity.TestOutputFormatValidity object at 0x7627fde17890>,
        result=AnalysisResult(ip_address=IPv4Address('0.0.0.0'),
         scan_timestamp=datetime.datetime(2020, 1, 1, 0, 0),
         classifications=[],
         local_info=None,
         internet_info=None,
         application_info=dict([]),
         errors=[]),
        verbosity_mode='dense',
    )
/home/andreas/kiro/ip-man2/tests/property/test_output_format_validity.py:257: AssertionError: Should contain report title
E   AssertionError: Should have exactly one primary certificate result for identical certificates
    assert 2 == 1
     +  where 2 = len([SSLResult(port=443, protocol='TLS', certificate={'subject': "<MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().subject' id='129914084352864'>", 'issuer': "<MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().issuer' id='129914084354256'>", 'serial_number': "<MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().serial_number' id='129914084384288'>", 'not_valid_before': <MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().not_valid_before.isoformat()' id='129914084572816'>, 'not_valid_after': <MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().not_valid_after.isoformat()' id='129914084065648'>}, cipher_suites=[], vulnerabilities=['SSL 2.0 enabled (CRITICAL)', 'SSL 3.0 enabled (HIGH - POODLE vulnerability)', 'TLS 1.0 enabled (MEDIUM - deprecated)', 'TLS 1.1 enabled (...='129914085731280'>", 'issuer': "<MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().issuer' id='129914085732672'>", 'serial_number': "<MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().serial_number' id='129914084796048'>", 'not_valid_before': <MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().not_valid_before.isoformat()' id='129914093019664'>, 'not_valid_after': <MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().not_valid_after.isoformat()' id='129914092483072'>}, cipher_suites=[], vulnerabilities=['SSL 2.0 enabled (CRITICAL)', 'SSL 3.0 enabled (HIGH - POODLE vulnerability)', 'TLS 1.0 enabled (MEDIUM - deprecated)', 'TLS 1.1 enabled (MEDIUM - deprecated)', 'Heartbleed vulnerability (CRITICAL)', 'OpenSSL CCS Injection vulnerability (HIGH)', 'TLS compression enabled (MEDIUM - CRIME attack)', 'Client renegotiation DoS vulnerability (MEDIUM)'])])
    Falsifying example: test_identical_certificates_reported_once(
        self=<tests.property.test_ssl_certificate_deduplication.TestSSLCertificateDeduplication object at 0x7627fde67b30>,
        ip=IPv4Address('1.1.1.1'),
        ssl_ports=[443, 8443, 993],
    )
------------------------------ Captured log call -------------------------------
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
/home/andreas/kiro/ip-man2/tests/property/test_ssl_certificate_deduplication.py:222: AssertionError: Should have exactly one primary certificate result for identical certificates
E   AssertionError: Identical certificates should have same subject
    assert "<MagicMock n...14089858656'>" == "<MagicMock n...14082423488'>"
      
      - <MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().subject' id='129914082423488'>
      ?                                                                                                                                                               ^^^^^
      + <MagicMock name='mock.scan_result.certificate_info.result.certificate_deployments.__getitem__().received_certificate_chain.__getitem__().subject' id='129914089858656'>
      ?                                                                        ...
      
      ...Full output truncated (1 line hidden), use '-vv' to show
    Falsifying example: test_certificate_deduplication_with_port_differences(
        self=<tests.property.test_ssl_certificate_deduplication.TestSSLCertificateDeduplication object at 0x7627fde8c230>,
        ip=IPv4Address('1.1.1.1'),
        ssl_ports=[443, 443],
    )
------------------------------ Captured log call -------------------------------
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
WARNING  src.ip_sentinel.modules.local_info:local_info.py:932 Error checking certificate issues: '<' not supported between instances of 'MagicMock' and 'datetime.datetime'
/home/andreas/kiro/ip-man2/tests/property/test_ssl_certificate_deduplication.py:438: AssertionError: Identical certificates should have same subject
E   AssertionError: False is not true
------------------------------ Captured log call -------------------------------
WARNING  src.ip_sentinel.modules.application:application.py:496 Failed to query IP ranges: API error: 500 - Server error
ERROR    src.ip_sentinel.modules.application:application.py:698 Unexpected error querying NetBox: '>=' not supported between instances of 'Mock' and 'int'
/home/andreas/anaconda3/lib/python3.12/unittest/case.py:727: AssertionError: False is not true
E   AssertionError: 0 != 1
/home/andreas/anaconda3/lib/python3.12/unittest/case.py:878: AssertionError: 0 != 1
=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/hypothesis/strategies/_internal/core.py:1983
  /home/andreas/kiro/ip-man2/venv/lib/python3.12/site-packages/hypothesis/strategies/_internal/core.py:1983: HypothesisDeprecationWarning: There is no reason to use @st.composite on a function which does not call the provided draw() function internally.
    note_deprecation(

tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_public_ipv4
  /home/andreas/kiro/ip-man2/venv/lib/python3.12/site-packages/sslyze/plugins/certificate_info/trust_stores/trust_store.py:55: CryptographyDeprecationWarning: Parsed a negative serial number, which is disallowed by RFC 5280. Loading this certificate will cause an exception in the next release of cryptography.
    self._x509_store = Store(load_pem_x509_certificates(self.path.read_bytes()))

tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_public_ipv4
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_local_analysis_completeness
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_analysis_methods_attempted
  /home/andreas/kiro/ip-man2/src/ip_sentinel/modules/local_info.py:601: CryptographyDeprecationWarning: Properties that return a naÃ¯ve datetime object have been deprecated. Please switch to not_valid_before_utc.
    'not_valid_before': cert.not_valid_before.isoformat(),

tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_public_ipv4
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_local_analysis_completeness
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_analysis_methods_attempted
  /home/andreas/kiro/ip-man2/src/ip_sentinel/modules/local_info.py:602: CryptographyDeprecationWarning: Properties that return a naÃ¯ve datetime object have been deprecated. Please switch to not_valid_after_utc.
    'not_valid_after': cert.not_valid_after.isoformat(),

tests/integration/test_end_to_end_analysis.py::TestEndToEndAnalysis::test_complete_analysis_public_ipv4
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_local_analysis_completeness
tests/property/test_local_network_analysis.py::TestLocalNetworkAnalysisCompleteness::test_analysis_methods_attempted
  /home/andreas/kiro/ip-man2/src/ip_sentinel/modules/local_info.py:906: CryptographyDeprecationWarning: Properties that return a naÃ¯ve datetime object have been deprecated. Please switch to not_valid_after_utc.
    if cert.not_valid_after < now:

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_query_all_enabled_success
FAILED tests/integration/test_application_module_integration.py::TestApplicationModuleIntegration::test_standardized_result_formatting
FAILED tests/property/test_application_integration_error_handling.py::TestApplicationIntegrationErrorHandling::test_missing_configuration_handling
FAILED tests/property/test_configuration_file_processing.py::test_cli_args_override_config_file
FAILED tests/property/test_database_persistence.py::TestDatabasePersistence::test_scan_result_storage_completeness
FAILED tests/property/test_full_mode_completeness.py::TestFullModeCompleteness::test_full_mode_consistency_across_formatters
FAILED tests/property/test_ip_version_consistency.py::TestIPVersionConsistency::test_analyzer_version_consistency
FAILED tests/property/test_module4_access_control.py::TestModule4AccessControl::test_module4_requires_explicit_submodule_specification
FAILED tests/property/test_output_format_validity.py::TestOutputFormatValidity::test_human_format_validity
FAILED tests/property/test_ssl_certificate_deduplication.py::TestSSLCertificateDeduplication::test_identical_certificates_reported_once
FAILED tests/property/test_ssl_certificate_deduplication.py::TestSSLCertificateDeduplication::test_certificate_deduplication_with_port_differences
FAILED tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_partial_failure_interface_query
FAILED tests/unit/test_netbox_submodule.py::TestNetBoxSubmodule::test_query_ip_success_with_full_data
=========== 13 failed, 245 passed, 11 warnings in 1676.42s (0:27:56) ===========
